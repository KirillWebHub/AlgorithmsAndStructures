<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4</title>
    <link rel="stylesheet" href="../styles/lab0/lab0.css">
    <link rel="stylesheet" href="../styles/IndexStyle/header.css">
    <!-- Prism.js –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />
</head>
<body>
    <header class="header_site">
        <div class="logo">ITMO</div>
        <nav class="navBar">
            <ul class="listNavBar">
                <li class="item1 itemListNavbar"><a href="../Home.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="item2 itemListNavbar"><a href="../index.html">–ó–∞–¥–∞–Ω–∏—è</a></li>
                <li class="item3 itemListNavbar"><a href="../WebSite.html">–û —Å–∞–π—Ç–µ</a></li>
            </ul>
        </nav>
    </header>

    <div class="lab-container">
        <header class="lab-header">
            <div class="lab-number">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4</div>
            <h1 class="lab-title" contenteditable="true">–ü–æ–∏—Å–∫ –ø–æ —Å—Ö–µ–º–µ –ö–Ω—É—Ç–∞-–ú–æ—Ä—Ä–∏—Å–∞-–ü—Ä–∞—Ç—Ç–∞ –∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</h1>
        </header>

        <section class="lab-section">
            <h2 class="section-title">–ó–∞–¥–∞–Ω–∏–µ</h2>
            <div class="lab-description" contenteditable="true">
                –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –ø–æ —Å—Ö–µ–º–µ –ö–Ω—É—Ç–∞-–ú–æ—Ä—Ä–∏—Å–∞-–ü—Ä–∞—Ç—Ç–∞ –Ω–∞ —è–∑—ã–∫–µ Java, –∑–∞—Ç–µ–º –∑–∞–ø–∏—Å–∞—Ç—å –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.
            </div>
        </section>

        <section class="lab-section">
            <h2 class="section-title">–ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä</h2>
            <div class="lab-description" contenteditable="true">
                –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ö–Ω—É—Ç–∞-–ú–æ—Ä—Ä–∏—Å–∞-–ü—Ä–∞—Ç—Ç–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ –∑–∞ O(n + m), –∞ —Ç–∞–∫–∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö "–∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ" –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π –≤—Ö–æ–∂–¥–µ–Ω–∏–π —Å –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –≤—Å—Ç–∞–≤–∫–∏ –∏ –ø–æ–∏—Å–∫–∞ –∑–∞ O(log n).
            </div>
        </section>

        <section class="lab-section">
            <h2 class="section-title">–†–µ–∞–ª–∏–∑–∞—Ü–∏—è KnuthMorrisPratt.java</h2>
            <div class="code-container">
                <pre class="line-numbers"><code class="language-java">// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ö–Ω—É—Ç–∞-–ú–æ—Ä—Ä–∏—Å–∞-–ü—Ä–∞—Ç—Ç–∞
package backend.algorithms;

import java.util.ArrayList;
import java.util.List;

public class KnuthMorrisPratt {

	/**
		* –°—Ç—Ä–æ–∏—Ç œÄ-—Ñ—É–Ω–∫—Ü–∏—é (–ø—Ä–µ—Ñ–∏–∫—Å-—Ñ—É–Ω–∫—Ü–∏—é) –¥–ª—è —à–∞–±–ª–æ–Ω–∞ p
		* 
		* @return –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã m, –≥–¥–µ pi[i] = –¥–ª–∏–Ω–∞ –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ
		*         –ø—Ä–µ—Ñ–∏–∫—Å–∞-—Å—É—Ñ—Ñ–∏–∫—Å–∞ –¥–ª—è p[0..i]
		*/
	public int[] buildPrefixFunction(char[] p) {
		int m = p.length;
		int[] pi = new int[m];
		pi[0] = 0;
		int k = 0;
		for (int i = 1; i < m; i++) {
			while (k > 0 && p[k] != p[i]) {
				k = pi[k - 1];
			}
			if (p[k] == p[i]) {
				k++;
			}
			pi[i] = k;
		}
		return pi;
	}

	/**
		* –ò—â–µ—Ç –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è pattern –≤ text.
		* 
		* @return —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –≤—Ö–æ–∂–¥–µ–Ω–∏–π
		*/
	public List<Integer> search(char[] text, char[] pattern) {
		List<Integer> result = new ArrayList<>();
		int n = text.length, m = pattern.length;
		if (m == 0 || n < m)
			return result;

		int[] pi = buildPrefixFunction(pattern);
		int q = 0; // —á–∏—Å–ª–æ —Å–∏–º–≤–æ–ª–æ–≤, —Å–æ–≤–ø–∞–≤—à–∏—Ö –¥–æ —Ç–µ–∫—É—â–µ–≥–æ i
		for (int i = 0; i < n; i++) {
			while (q > 0 && pattern[q] != text[i]) {
				q = pi[q - 1];
			}
			if (pattern[q] == text[i]) {
				q++;
			}
			if (q == m) {
				// –Ω–∞–π–¥–µ–Ω–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ, –µ–≥–æ –∫–æ–Ω–µ—Ü ‚Äî i, –Ω–∞—á–∞–ª–æ ‚Äî i-m+1
				result.add(i - m + 1);
				q = pi[q - 1]; // –≥–æ—Ç–æ–≤–∏–º—Å—è –∏—Å–∫–∞—Ç—å –¥–∞–ª—å—à–µ
			}
		}
		return result;
	}

	// –î–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–±–∞–≤–∏–º –º–µ—Ç–æ–¥ main.

	public static void main(String[] args) {
		String txt = "ababcabcabababd";
		String pat = "ababd";
		KnuthMorrisPratt kmp = new KnuthMorrisPratt();
		System.out.println("TXT = " + txt);
		System.out.println("PAT = " + pat);
		System.out.println("Matches at: " + kmp.search(txt.toCharArray(), pat.toCharArray()));
	}
}
				</code></pre>
            </div>
        </section>

        <section class="lab-section">
            <h2 class="section-title">–†–µ–∞–ª–∏–∑–∞—Ü–∏—è RedBlackTree.java</h2>
            <div class="code-container">
                <pre class="line-numbers"><code class="language-java">// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π –≤—Ö–æ–∂–¥–µ–Ω–∏–π
package backend.structures;

public class RedBlackTree {
	private RedBlackTreeNode root;

	public void insert(int key) {
		RedBlackTreeNode inserted = bstInsertReturnInserted(key);
		fixViolation(inserted);
	}

	private RedBlackTreeNode bstInsertReturnInserted(int key) {
		RedBlackTreeNode node = new RedBlackTreeNode(key);
		RedBlackTreeNode current = root;
		RedBlackTreeNode parent = null;

		while (current != null) {
			parent = current;
			if (key < current.key) {
				current = current.left;
			} else {
				current = current.right;
			}
		}

		node.parent = parent;

		if (parent == null) {
			root = node;
		} else if (key < parent.key) {
			parent.left = node;
		} else {
			parent.right = node;
		}

		return node;
	}

	private void fixViolation(RedBlackTreeNode z) {
		while (z != root && z.parent.color == RedBlackTreeNode.RED) {
			if (z.parent == z.parent.parent.left) {
				RedBlackTreeNode y = z.parent.parent.right;
				if (y != null && y.color == RedBlackTreeNode.RED) {
					z.parent.color = RedBlackTreeNode.BLACK;
					y.color = RedBlackTreeNode.BLACK;
					z.parent.parent.color = RedBlackTreeNode.RED;
					z = z.parent.parent;
				} else {
					if (z == z.parent.right) {
						z = z.parent;
						leftRotate(z);
					}
					z.parent.color = RedBlackTreeNode.BLACK;
					z.parent.parent.color = RedBlackTreeNode.RED;
					rightRotate(z.parent.parent);
				}
			} else {
				RedBlackTreeNode y = z.parent.parent.left;
				if (y != null && y.color == RedBlackTreeNode.RED) {
					z.parent.color = RedBlackTreeNode.BLACK;
					y.color = RedBlackTreeNode.BLACK;
					z.parent.parent.color = RedBlackTreeNode.RED;
					z = z.parent.parent;
				} else {
					if (z == z.parent.left) {
						z = z.parent;
						rightRotate(z);
					}
					z.parent.color = RedBlackTreeNode.BLACK;
					z.parent.parent.color = RedBlackTreeNode.RED;
					leftRotate(z.parent.parent);
				}
			}
		}
		root.color = RedBlackTreeNode.BLACK;
	}

	private void leftRotate(RedBlackTreeNode x) {
		RedBlackTreeNode y = x.right;
		x.right = y.left;
		if (y.left != null)
			y.left.parent = x;
		y.parent = x.parent;
		if (x.parent == null)
			root = y;
		else if (x == x.parent.left)
			x.parent.left = y;
		else
			x.parent.right = y;
		y.left = x;
		x.parent = y;
	}

	private void rightRotate(RedBlackTreeNode y) {
		RedBlackTreeNode x = y.left;
		y.left = x.right;
		if (x.right != null)
			x.right.parent = y;
		x.parent = y.parent;
		if (y.parent == null)
			root = x;
		else if (y == y.parent.left)
			y.parent.left = x;
		else
			y.parent.right = x;
		x.right = y;
		y.parent = x;
	}

	public String getTreeString() {
		StringBuilder sb = new StringBuilder();
		buildTreeString(root, 0, sb);
		return sb.toString();
	}

	private void buildTreeString(RedBlackTreeNode node, int depth, StringBuilder sb) {
		if (node != null) {
			buildTreeString(node.right, depth + 1, sb);
			sb.append("  ".repeat(depth)).append(node.toString()).append("\n");
			buildTreeString(node.left, depth + 1, sb);
		}
	}

	public void printInOrder() {
		System.out.println("RB-Tree in-order:");
		printInOrder(root, 0);
	}

	private void printInOrder(RedBlackTreeNode node, int depth) {
		if (node != null) {
			printInOrder(node.right, depth + 1);
			System.out.printf("%s%s%n", "  ".repeat(depth), node.toString());
			printInOrder(node.left, depth + 1);
		}
	}

	// üîß –î–ª—è —Ç–µ—Å—Ç–æ–≤
	public static void main(String[] args) {
		RedBlackTree tree = new RedBlackTree();
		tree.insert(10);
		tree.insert(7);
		tree.insert(3);
		tree.insert(11);
		tree.printInOrder();
	}
}
					
</code></pre>
            </div>
        </section>

        <section class="lab-section">
            <h2 class="section-title">–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>
            <div class="input-group">
                <label>–í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞</label>
                <input type="file" id="input-file" accept=".txt">
            </div>
            <div class="input-group">
                <label>–í–∞—Ä–∏–∞–Ω—Ç 2: –í–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é</label><br>
                <input type="text" id="text-input" placeholder="–¢–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞"><br>
                <input type="text" id="pattern-input" placeholder="–®–∞–±–ª–æ–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞">
            </div>
            <button id="run" class="sortButton">–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–∏—Å–∫</button>
        </section>

        <section class="lab-section">
            <h2 class="section-title">–ö–æ–Ω—Å–æ–ª—å –≤—ã–≤–æ–¥–∞</h2>
            <div class="code-container" style="background-color: #111827;">
                <pre id="output-console" style="color: #10b981; font-family: monospace;">[–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å]</pre>
            </div>
        </section>

        <footer class="footer-meta">
            <span class="deadline">–í—ã–ø–æ–ª–Ω–∏–ª –ú–∏—Ç–∏—á–∫–∏–Ω –ö.–ê</span>
            <span class="status">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</span>
        </footer>
    </div>
</body>
<script src="../scripts/lab4/server4.js"></script>
</html>
